{"title":"React笔记: 2.1 classComponent 生命周期——挂载阶段","date":"2021-03-26T12:34:36.000Z","date_formatted":{"ll":"2021年3月26日","L":"2021/03/26","MM-DD":"03-26"},"link":"20210326/React笔记-2-1-classComponent-生命周期——挂载阶段","tags":["React"],"updated":"2021-04-04T14:36:44.597Z","content":"<blockquote>\n<p>reference: <a href=\"https://react.docschina.org/docs/react-component.html\">https://react.docschina.org/docs/react-component.html</a></p>\n</blockquote>\n<iframe \n    style=\"border:1px solid #ccc;border-radius:2px;width:100%;height:300px;\" \n    src=\"/public/$utils/code.html?type=javascript&url=/public/react-doc/02/classComponentLifeCycle.jsx\">\n</iframe>\n<h2 id=\"挂载阶段\">挂载阶段<a title=\"#挂载阶段\" href=\"#挂载阶段\"></a></h2>\n<p><code>constructor -&gt; static getDerivedStateFromProps -&gt; render -&gt; componentDidMount</code></p>\n<pre class=\"mermaid\">graph TD\n    Constructor[constructor] --> GetDerivedStateFromProps[static getDerivedStateFromProps]\n    GetDerivedStateFromProps[static getDerivedStateFromProps] --> Render[render]\n    Render[render] --> componentDidMount(componentDidMount)</pre>\n<h3 id=\"constructor-function Object() { [native code] }1\">constructor<a title=\"#constructor-function Object() { [native code] }1\" href=\"#constructor-function Object() { [native code] }1\"></a></h3>\n<ul>\n<li>处理 props 默认值（可以用defaultProps，还是推荐用defaultProps），但是有一些问题：</li>\n<li>⭐处理 state 默认值</li>\n<li>原来有人用<code>bind(this)</code> 处理事件，但是现在都用箭头函数了。</li>\n</ul>\n<p><a href=\"/20210404/React%E7%AC%94%E8%AE%B0-2-1-1-classComponent-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F_defaultProps%E7%B1%BB%E5%9E%8B%E6%8F%90%E7%A4%BA%E5%9D%91%E7%9A%84%E5%86%99%E6%B3%95\"><strong>typescript 下，安全 defaultProps 类型提示的写法：</strong></a></p>\n<h3 id=\"render-——-return-jsx\">render —— return JSX<a title=\"#render-——-return-jsx\" href=\"#render-——-return-jsx\"></a></h3>\n<h3 id=\"componentdidmount\">componentDidMount<a title=\"#componentdidmount\" href=\"#componentdidmount\"></a></h3>\n<p>进行 useEffect 的 一堆副作用操作，例如：</p>\n<ul>\n<li>依赖于 DOM 节点的初始化应该放在这里。</li>\n<li>定时器</li>\n<li>如需通过网络请求获取数据，此处是实例化请求的好地方。</li>\n<li>这个方法是比较适合添加订阅的地方。如果添加了订阅，请不要忘记在 componentWillUnmount() 里取消订阅</li>\n</ul>\n<p>但是如果在之前执行，则会阻碍组件的实例化，阻碍组件的渲染</p>\n<p>!! 你可以在 componentDidMount() 里直接调用 setState()。它将触发额外渲染，但此渲染会发生在浏览器更新屏幕之前。如此保证了即使在 render() 两次调用的情况下，用户也不会看到中间状态。请谨慎使用该模式，因为它会导致性能问题。通常，你应该在 constructor() 中初始化 state。如果你的渲染依赖于 DOM 节点的大小或位置，比如实现 modals 和 tooltips 等情况下，你可以使用此方式处理</p>\n","prev":{"title":"React笔记: 2.1.1 classComponent 生命周期 defaultProps类型提示坑的写法","link":"20210404/React笔记-2-1-1-classComponent-生命周期_defaultProps类型提示坑的写法"},"next":{"title":"React笔记: 1.classComponent 与 FunctionComponent HelloWorld","link":"20210326/React笔记-1-classComponent-与-FunctionComponent-HelloWorld"},"plink":"https://xn--vqq264efum.com/20210326/React笔记-2-1-classComponent-生命周期——挂载阶段/","toc":[{"id":"挂载阶段","title":"挂载阶段","index":"1","children":[{"id":"constructor-function Object() { [native code] }1","title":"constructor","index":"1.1"},{"id":"render-——-return-jsx","title":"render —— return JSX","index":"1.2"},{"id":"componentdidmount","title":"componentDidMount","index":"1.3"}]}],"reading_time":"352 字约 2 分钟"}